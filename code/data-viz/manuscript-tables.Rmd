---
title: "Tables for PM2.5 Components Paper Manuscript"
author: "Fatemeh Kazemi"
date: "05/31/2021"
output:
  html_document:
    df_print: paged
---


```{r}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r load packages}
library(tidyverse)
library(here)
library(flextable)
library(officer)
```

```{r Call Functions}
source(here('code','data-viz','manuscript-table-functions.R'))
```

```{r Load data}
load(here('data','processed', 'pmc-daily.RDa'))
load(here('data','processed','pmc-site-ndi.RDa'))

load(here('output','analysis','out-pmc-ses.RDa'))
load(here('output','analysis','out-fac-ses.RDa'))
load(here('output','analysis','out-pmc-resid.RDa'))
load(here('output','analysis','out-fac-resid.RDa'))
load(here('output','analysis','out-pmc-age.RDa'))
load(here('output','analysis','out-fac-age.RDa'))
load(here('output','analysis','out-pmc-sex.RDa'))
load(here('output','analysis','out-fac-sex.RDa'))
load(here('output','analysis','out-pmc-race.RDa'))
load(here('output','analysis','out-fac-race.RDa'))
load(here('output','analysis','out-pmc-urbanicity.RDa'))
load(here('output','analysis','out-fac-urbanicity.RDa'))
load(here('output','analysis','out-pmc-sescat.RDa'))
load(here('output','analysis','out-pmc-region.RDa'))
load(here('output','analysis','out-pmc-resid-region.RDa'))
load(here('output','analysis','out-fac-region.RDa'))
load(here('output','analysis','out-pmc-brfss.RDa'))
load(here('output','analysis','out-pmc-buffer.RDa'))
load(here('output','analysis','out-pmc-expo.RDa'))
```

```{r}
cuz <- c("All-Cause", "Cardiovascular", "IHD", "CBV", "CHF",
         "Respiratory", "COPD", "Pneumonia", 
         "Cancer", "Lung Cancer")

cuz.top.row <-  c ("All-Cause", "Cardiovascular", "IHD", "CBV", "CHF")
cuz.bot.row <- c ("Respiratory", "COPD", "Pneumonia", "Cancer", "Lung Cancer")

cmp.main <- c("PM2.5", "Si","Ca", "Pb","Zn", "NO3","OC", "K","Cu",
              "Se","SO4", "Na","Cl", "Ni","V", "Fe","Mn")

cmp.multi <- c("PM2.5","Si", "Ca", "Pb", "Zn", "NO3", "OC", "Se", "SO4", 
               "Ni", "V") 

So.main <- c("Soil", "Metals", "Traffic", "Biomass",
             "Coal", "Salt", "Oil", "Steel")

So.multi <- c("Soil", "Metals", "Traffic", "Coal", "Oil")

cmp.res <- c("PM2.5", "-Si","-Ca", "-Pb","-Zn", "-NO3","-OC",
             "-Se","-SO4", "-Ni","-V")

So.res <- c("PM2.5", "-Soil", "-Metals", "-Traffic", "-Coal", "-Oil")

cmp.multi.res <- c("PM2.5","-Si", "-Ca", "-Pb", "-Zn", "-NO3", "-OC",
                   "-Se", "-SO4", "-Ni", "-V")
```

### Table 2
```{r}
dt.pmc <- dt.pmc.site.ndi %>% 
  mutate(Loc.Set = ifelse(Location.Setting == "RURAL", "Rural", "Urban"),
         Region = ifelse(Region.IV == 1, "West",
                         ifelse(Region.IV == 2, "Midwest",
                                ifelse(Region.IV == 3, "South", "Northeast"))),
         Region = factor(Region, levels = c("West", "Midwest", "South", "Northeast"))) %>%
  select(Site.ID, Region, Loc.Set) %>% 
  merge(dt.pmc.daily) %>% 
  pivot_longer(AS:PM,
               names_to = "Parameter",
               values_to = "Value")

table.region <- dt.pmc %>% 
  group_by(Parameter, Region) %>% 
  summarise(Mean = sprintf("%0.2f", mean(Value*1000)),
            STD = sprintf("%0.2f", sd(Value*1000)))

table.urban <- dt.pmc %>% 
  group_by(Parameter, Loc.Set) %>% 
  summarise(Mean = sprintf("%0.2f", mean(Value*1000)),
            STD = sprintf("%0.2f", sd(Value*1000))) %>% 
  mutate(Region = Loc.Set,
         Region = factor(Region, levels = c("Urban", "Rural"))) %>% 
  select(-Loc.Set) %>% 
  arrange(Region)

cmp <- c("PM", "AS", "CA", "CL", "CU", "FE", "K", "MG", "MN", "NA", "NI",
         "NO3", "OC", "PB", "SE", "SI", "SO4", "V", "ZN")

table <- dt.pmc %>% 
  group_by(Parameter) %>% 
  summarise(Mean = sprintf("%0.2f", mean(Value*1000)),
            STD = sprintf("%0.2f", sd(Value*1000))) %>% 
  mutate(Region = "US",
         Region = factor(Region, levels = c("US"))) %>% 
  as.data.frame() %>% 
  add_row(table.region) %>% 
  add_row(table.urban) %>% 
  filter(Parameter != "EC") %>% 
  mutate(test = paste(Mean,"±",STD, sep = " ")) %>% 
  select(-Mean, -STD) %>% 
  pivot_wider(names_from = "Region",
              values_from = "test",
              names_sort = F) %>% 
  mutate(Parameter = factor(Parameter, levels = cmp)) %>% 
  arrange(Parameter) %>% 
  rename(Component = Parameter)

ft <- flextable(table)
ft <- theme_booktabs(ft)
ft <- vline(ft, j = c('Component', 'US', 'Northeast'))
ft <- hline(ft, i = c(1, 4, 7, 10, 13, 16))
ft <- padding(ft, padding = 0)
ft <- fontsize(ft, size = 10)
ft <- set_caption(ft, caption = "Table 2. Daily concentrations of PM2.5 and its components, mean ± standard deviation, nationwide, by region and urbanicity.")
ft <- fontsize(ft, i = 1, size = 12, part = "header")
ft <- autofit(ft)

doc <- read_docx()
doc <- body_add_flextable(doc, value = ft, split = T)
doc <- body_add_par(doc, "Units are ng/m3 unless specified", style = "Normal")
body_add(doc, run_pagebreak())
```

### Table 3
```{r}
fit <- factanal(dt.pmc.daily %>% select(AS:ZN, OC), 8, rotation="varimax")
factor.loadings <- rbind(fit$loadings) %>% as.data.frame()
factor.loadings <- rownames_to_column(factor.loadings, "Component")

colnames(factor.loadings) <- c("Component", "Soil", "Metals", "Traffic", 
                               "Biomass Combustion", "Coal combustion", "Salt", 
                               "Residual Oil Combustion", "Steel Industry") 
factor.loadings <- factor.loadings %>% 
  mutate_at(.vars = c("Soil", "Metals", "Traffic", "Biomass Combustion", 
                      "Coal combustion", "Salt", "Residual Oil Combustion", 
                      "Steel Industry"), ~sprintf('%.2f', .x))

ft <- flextable(factor.loadings)
ft <- theme_booktabs(ft)
ft <- vline(ft, j = c('Component'))
ft <- hline(ft, i = c(3, 6, 9, 12, 15))
ft <- padding(ft, padding = 0)
ft <- fontsize(ft, size = 10)
ft <- set_caption(ft, caption = "Table 3. Loadings of each component for eight identified factors.")
ft <- fontsize(ft, i = 1, size = 12, part = "header")
ft <- autofit(ft)

doc <- body_add_flextable(doc, value = ft, split = T)
body_add(doc, run_pagebreak())

print(doc, target = here('output','table','main-tables.docx'))
```

### Figure 1 - Components SES
```{r}
doc <- read_docx()
doc <- Table.Single(dt = out.pmc.ses, cmp = cmp.main, cuz = cuz.top.row,
                 cpt = "Table S2. Mortality hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.pmc.ses, cmp = cmp.main, cuz = cuz.bot.row,
                 cpt = "Table S2. Mortality hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 2 - Factors SES
```{r}
doc <- Table.Single(dt = out.fac.ses, cmp = So.main, cuz = cuz.top.row,
                 cpt = "Table S3. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.fac.ses, cmp = So.main, cuz = cuz.bot.row,
                 cpt = "Table S3. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 3 - PM-Components Residual
```{r}
doc <- Table.Single(dt = out.pmc.resid, cmp = cmp.res, cuz = cuz.top.row,
                 cpt = "Table S4. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.pmc.resid, cmp = cmp.res, cuz = cuz.bot.row,
                 cpt = "Table S4. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 4 - PM-Factors Residual
```{r}
doc <- Table.Single(dt = out.fac.resid, cmp = So.res, cuz = cuz.top.row,
                 cpt = "Table S5. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from source-related factor scores.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.fac.resid, cmp = So.res, cuz = cuz.bot.row,
                 cpt = "Table S5. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from source-related factor scores., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 5 - Components Race
```{r}
out.pmc.race <- out.pmc.race %>% 
  mutate(Race = ifelse(Race == "A", "Asian",
                       ifelse(Race == "B", "Black",
                              ifelse(Race == "H", "Hispanic", "White"))))

doc <- Table.Multi.race(dt = out.pmc.race, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S6. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by race.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.race(dt = out.pmc.race, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S6. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by race., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 6 - Factors Race
```{r}
out.fac.race <- out.fac.race %>% 
  mutate(Race = ifelse(Race == "A", "Asian",
                       ifelse(Race == "B", "Black",
                              ifelse(Race == "H", "Hispanic", "White"))))

doc <- Table.Multi.race(dt = out.fac.race, cmp = So.multi, cuz = cuz.top.row,
                 cpt = "Table S7. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by race.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.race(dt = out.fac.race, cmp = So.multi, cuz = cuz.bot.row,
                 cpt = "Table S7. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by race., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 7 - Components Age
```{r}
out.pmc.age <- out.pmc.age %>% 
  mutate(Age = ifelse(Age == "LE75", "65-75", "> 75"),
         Age = factor(Age, levels = c("65-75", "> 75")))

doc <- Table.Multi.age(dt = out.pmc.age, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S8. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: By age.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.age(dt = out.pmc.age, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S8. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: By age., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 8 - Factors Age
```{r}
out.fac.age <- out.fac.age %>% 
  mutate(Age = ifelse(Age == "LE75", "65-75", "> 75"),
         Age = factor(Age, levels = c("65-75", "> 75")))

doc <- Table.Multi.age(dt = out.fac.age, cmp = So.multi, cuz = cuz.top.row,
                 cpt = "Table S9. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: By age.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.age(dt = out.fac.age, cmp = So.multi, cuz = cuz.bot.row,
                 cpt = "Table S9. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: By age., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 9 - Components Sex
```{r}
out.pmc.sex <- out.pmc.sex %>% 
  mutate(Sex = ifelse(Sex == "F", "Female", "Male"))

doc <- Table.Multi.sex(dt = out.pmc.sex, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S10. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by sex.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.sex(dt = out.pmc.sex, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S10. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by sex., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 10 - Factors Sex
```{r}
out.fac.sex <- out.fac.sex %>% 
  mutate(Sex = ifelse(Sex == "F", "Female", "Male"))

doc <- Table.Multi.sex(dt = out.fac.sex, cmp = So.multi, cuz = cuz.top.row,
                 cpt = "Table S11. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by sex.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.sex(dt = out.fac.sex, cmp = So.multi, cuz = cuz.bot.row,
                 cpt = "Table S11. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by sex., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure 11 - Components SES-urban
```{r}
out.pmc.sescat <- out.pmc.sescat %>% 
  mutate(SES.Cat = ifelse(SES.Cat == "L", "Low",
                          ifelse(SES.Cat == "M", "Middle", "High")),
         SES.Cat = factor(SES.Cat, levels = c("Low", "Middle", "High")))

doc <- Table.Multi.sescat(dt = out.pmc.sescat, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S12. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by income category in urban areas.", ftnt = "Continued ...")
doc <- Table.Multi.sescat(dt = out.pmc.sescat, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S12. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by income category in urban areas., Continued", ftnt = "")
```

### Figure S3 - Components Urban
```{r}
doc <- Table.Single(dt = out.pmc.urbanicity %>% filter(Loc.Set == "urban") %>%
                      select(-Loc.Set),
                    cmp = cmp.main, cuz = cuz.top.row,
                 cpt = "Table S13. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components in urban areas.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.pmc.urbanicity%>% filter(Loc.Set == "urban") %>% 
                      select(-Loc.Set),
                    cmp = cmp.main, cuz = cuz.bot.row,
                 cpt = "Table S13. Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components in urban areas., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S4 - factors Urban
```{r}
doc <- Table.Single(dt = out.fac.urbanicity %>% filter(Loc.Set == "urban") %>% 
                      select(-Loc.Set),
                    cmp = So.main, cuz = cuz.top.row,
                 cpt = "Table S14. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors in urban areas.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Single(dt = out.fac.urbanicity%>% filter(Loc.Set == "urban") %>% 
                      select(-Loc.Set),
                    cmp = So.main, cuz = cuz.bot.row,
                 cpt = "Table S14. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors in urban areas., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S5 - Components Region
```{r}
out.pmc.region <- out.pmc.region %>% 
  mutate(Region = ifelse(Region == "west", "West",
                         ifelse(Region == "midwest", "Midwest",
                                ifelse(Region == "south", "South", "Northeast"))),
         Region = factor(Region, levels = c("West", "Midwest", "South", "Northeast")))

doc <- Table.Multi.region(dt = out.pmc.region, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S15.  Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by region.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.region(dt = out.pmc.region, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S15.  Mortality Hazard ratios (95% CI) associated with an IQR increase in PM2.5 and its components: by region., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S6 - Factors Region
```{r}
out.fac.region <- out.fac.region %>% 
  mutate(Region = ifelse(Region == "west", "West",
                         ifelse(Region == "midwest", "Midwest",
                                ifelse(Region == "south", "South", "Northeast"))),
         Region = factor(Region, levels = c("West", "Midwest", "South", "Northeast")))

doc <- Table.Multi.region(dt = out.fac.region, cmp = So.multi, cuz = cuz.top.row,
                 cpt = "Table S16. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by region.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.region(dt = out.fac.region, cmp = So.multi, cuz = cuz.bot.row,
                 cpt = "Table S16. Mortality Hazard ratios (95% CI) associated with an IQR increase in source factors: by region., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S7 - Components Residual Region
```{r}
out.pmc.resid.region <- out.pmc.resid.region %>% 
  mutate(Region = ifelse(Region == "west", "West",
                         ifelse(Region == "midwest", "Midwest",
                                ifelse(Region == "south", "South", "Northeast"))),
         Region = factor(Region, levels = c("West", "Midwest", "South", "Northeast")))

doc <- Table.Multi.region(dt = out.pmc.resid.region, cmp = cmp.multi.res, cuz = cuz.top.row,
                 cpt = "Table S17. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: by region.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.region(dt = out.pmc.resid.region, cmp = cmp.multi.res, cuz = cuz.bot.row,
                 cpt = "Table S17. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: by region., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S8 - Components BRFSS
```{r}
out.pmc.brfss <- out.pmc.brfss %>% 
  mutate(BRFSS = ifelse(BRFSS == "brfss0", "Base", "BRFSS-Adjusted"))

doc <- Table.Multi.brfss(dt = out.pmc.brfss, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S18. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: Base versus BRFSS-adjusted models for the subset of monitors with BRFSS data.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.brfss(dt = out.pmc.brfss, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S18. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: Base versus BRFSS-adjusted models for the subset of monitors with BRFSS data., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S9 - Components Buffer
```{r}
out.pmc.buffer <- out.pmc.buffer %>% 
  mutate(Buffer = ifelse(Buffer == "6", "6-miles",
                         ifelse(Buffer == "12", "12-miles", "24-miles")),
         Buffer = factor(Buffer, levels = c("6-miles", "12-miles", "24-miles")))

doc <- Table.Multi.buffer(dt = out.pmc.buffer, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S19. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: using 6-, 12- and 24-mile buffer zones to assess PM2.5 and its components exposures.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.buffer(dt = out.pmc.buffer, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S19. Mortality Hazard ratios (95% CI) associated with an IQR increase in total PM2.5 and in PM2.5 minus variability from specific components: using 6-, 12- and 24-mile buffer zones to assess PM2.5 and its components exposures., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```

### Figure S10 - Components Exposure Window
```{r}
out.pmc.expo <- out.pmc.expo %>% 
  mutate(Window = ifelse(Window == "1", "1-yr",
                         ifelse(Window == "2", "2-yr",
                                ifelse(Window == "3", "3-yr",
                                       ifelse(Window == "4", "4-yr", "5-yr")))))

doc <- Table.Multi.expo(dt = out.pmc.expo, cmp = cmp.multi, cuz = cuz.top.row,
                 cpt = "Table S20. Mortality Hazard ratios (95% CI) associated with an IQR increase in 1- to 5- years PM2.5 moving average exposure and its components for the subset of the monitors with complete data of 1 to 5 year moving average.", ftnt = "Continued ... Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
doc <- Table.Multi.expo(dt = out.pmc.expo, cmp = cmp.multi, cuz = cuz.bot.row,
                 cpt = "Table S20. Mortality Hazard ratios (95% CI) associated with an IQR increase in 1- to 5- years PM2.5 moving average exposure and its components for the subset of the monitors with complete data of 1 to 5 year moving average., Continued", ftnt = "Hazard ratios are age, sex, race and site stratified and adjusted for SES.")
```


```{r}
print(doc, target = here('output','table','supplement-tables.docx'))
```


